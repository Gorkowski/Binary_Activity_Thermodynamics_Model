function [y1] = inverted_NNMcGlashan_biphasic_orgPhase85to1_KGv4(x1)
%NN_BIPHASICORGRICH_LAYERS30 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Oct-2018 23:59:39.
% 
% [y1] = NN_biphasicOrgRich_layers30(x1) takes these arguments:
%   x = 3xQ matrix, input #1
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.00043947731310994;1.93618465343371e-05;0.85];
x1_step1.gain = [4.73564679292502;9.33014151076842;13.3333333333333];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.4014129756388524761;-4.2789807496733098802;1.2369220264724545277;0.59152256003078729218;-2.6552641070415505808;4.8957369146044875663;-3.0346411148216940745;-4.7171224770577122598;0.98021040967537087507;-1.7195770200898412572;-4.6630984212067270178;2.0712844196751221126;2.1547725621384157257;0.069110378562071000941;6.1648213487683971579;-2.8344659292357881064;0.10687550038722143375;-5.4567723093373379228;-2.3086510559324300296;-0.38110483342158663067;-3.5020946704884008405;-1.8381070705678763666;-5.0471346240604706423;-1.1248930912384289549;-2.7658640248501877856;2.6087535927195037999;-2.9511248936811762533;5.7673350955684501429;-5.4071165346961365117;2.484255278152515789];
IW1_1 = [1.2187833413210493738 -1.1728664510826536382 -0.2650904663641364678;2.853363940092880302 1.9400748461785570775 1.4625482097035846785;-1.3742144354245007243 -0.30433914027223074594 0.027102626509229624935;-1.1691674982318476239 -0.64446640422624235089 -0.013129196790090127966;1.027635365783574839 -1.4737002449866958287 -0.56361509495300099459;-3.0424776626974585625 7.4923247114073356911 -0.014651124107786430567;1.152871665364986864 2.7693911076008150829 -0.090872254159660215134;2.0178089442320237268 -7.723484356201820944 0.03769199684684317736;-2.6214272208039650636 -1.8420873668208845864 -0.042445458717942460836;-0.24419784788294224276 3.3809333793182623218 -1.2751319151272606511;2.5595088392301548197 -7.327579125403558713 0.022843179681009732895;-0.8946624212598237591 4.5661659724502241531 -0.10185922261558301438;-0.70369638292802105806 4.7237983573693149708 -0.10297961553903581255;1.5526096968752576277 1.0289384692397705034 0.0088733464619639764587;-1.8090899397916941904 10.546214945222944337 -0.05950475714543499578;-8.0795636740347127613 -1.2129407457305676488 0.022283601629406617206;2.0124766382365533168 -0.69643270614103758298 2.9256161737702521819;1.7917903313901901718 -9.2273668409957423364 0.051728642151668877136;0.34656035815173241721 -4.8658722386668760151 0.11273879738810002604;1.6584913546039381504 -2.6985039113486704032 0.076536817743111343337;-2.8763106590005693697 0.40506352905901354955 -1.3071435265517497015;-3.9282098332367110238 -0.82140363168866981081 -0.050734639357360084011;-7.1215277371223120184 0.93715680361746844795 -0.032779101927923687265;-1.4142779408544461361 2.1004802686254171462 -0.0097155285295429313908;-0.76147056337418739247 3.3438762051194648173 -0.10675713987208505784;1.2995442219378408044 1.3367373590023832186 0.11004659646840594944;-0.91043066254239590762 3.5023069315603607699 -0.096494331376355546581;3.0813090628757549005 2.7917276137175406348 -0.0080871324031461834514;-2.238483333070386383 -3.2326643533595200708 0.01069907371380929284;-1.4704611775220677305 -2.1752549671983918422 0.032491330764356313177];

% Layer 2
b2 = -3.225975217416820584;
LW2_1 = [-1.1407478117074021373 -0.91705043213972270433 -4.334240301063935874 7.8354135349497155971 0.27104158781122106303 2.9708329808292628371 -1.7137493635246430213 -10.254142752815239348 -0.81408306216864934068 -0.0059727036497528081943 8.0144939304079620968 2.8260324517824311208 -3.8245248236133484454 2.2388668570352177056 3.2744555176652450079 -0.082841937146871866271 0.0013667090817240097438 8.2712701663798799956 -1.1770702120310740924 -0.18442434417243092071 -0.0011150937563114626198 0.18774417810511359606 0.066099684263162511444 0.149099618027552977 -0.73772168397215309721 0.089045917430566778883 0.65000296279758273954 -5.2501042209173984787 -8.4580624751910011838 -3.735834646333171527];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.01974262421073;
y1_step1.xoffset = 0.00765839409111355;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
